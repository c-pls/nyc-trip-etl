COPY INTO {dest_table_name}(
    HVFHS_LICENSE_KEY,
    DISPATCHING_BASE_NUM,
    ORIGINATING_BASE_NUM,
    REQUEST_DATETIME,
    ON_SCENE_DATETIME,
    PICKUP_DATETIME,
    DROPOFF_DATETIME,
    PICKUP_DATE_KEY,
    DROPOFF_DATE_KEY,
    REQUEST_DATE_KEY,
    ON_SCENE_DATE_KEY,
    PICK_UP_LOCATION_KEY,
    DROP_OFF_LOCATION_KEY,
    TRIP_MILES,
    TRIP_TIME,
    BASE_PASSENGER_FARE,
    TOLLS,
    BCF,
    SALES_TAX,
    CONGESTION_SURCHARGE,
    AIRPORT_FEE,
    TIPS,
    DRIVER_PAY,
    SHARED_REQUEST_FLAG,
    SHARED_MATCH_FLAG,
    ACCESS_A_RIDE_FLAG,
    WAV_REQUEST_FLAG,
    WAV_MATCH_FLAG
)
FROM (
    SELECT
CAST($1:HVFHS_LICENSE_KEY AS VARCHAR(16777216)) AS HVFHS_LICENSE_KEY,
CAST($1:DISPATCHING_BASE_NUM AS VARCHAR(16777216)) AS DISPATCHING_BASE_NUM,
CAST($1:ORIGINATING_BASE_NUM AS VARCHAR(16777216)) AS ORIGINATING_BASE_NUM,
TO_TIMESTAMP_NTZ($1 :REQUEST_DATETIME::VARCHAR) AS REQUEST_DATETIME,
TO_TIMESTAMP_NTZ($1 :ON_SCENE_DATETIME::VARCHAR) AS ON_SCENE_DATETIME,
TO_TIMESTAMP_NTZ($1 :PICKUP_DATETIME::VARCHAR) AS PICKUP_DATETIME,
TO_TIMESTAMP_NTZ($1 :DROPOFF_DATETIME::VARCHAR) AS DROPOFF_DATETIME,
CAST($1 :PICKUP_DATE_KEY AS NUMBER(38,0)) AS PICKUP_DATE_KEY,
CAST($1 :DROPOFF_DATE_KEY AS NUMBER(38,0)) AS DROPOFF_DATE_KEY,
CAST($1 :REQUEST_DATE_KEY AS NUMBER(38,0)) AS REQUEST_DATE_KEY,
CAST($1 :ON_SCENE_DATE_KEY AS NUMBER(38,0)) AS ON_SCENE_DATE_KEY,
CAST($1 :PICK_UP_LOCATION_KEY AS NUMBER(38,0)) AS PICK_UP_LOCATION_KEY,
CAST($1 :DROP_OFF_LOCATION_KEY AS NUMBER(38,0)) AS DROP_OFF_LOCATION_KEY,
CAST($1 :TRIP_MILES AS FLOAT) AS TRIP_MILES,
CAST($1 :TRIP_TIME AS NUMBER(38,0)) AS TRIP_TIME,
CAST($1 :BASE_PASSENGER_FARE AS FLOAT) AS BASE_PASSENGER_FARE,
CAST($1 :TOLLS AS FLOAT) AS TOLLS,
CAST($1 :BCF AS FLOAT) AS BCF,
CAST($1 :SALES_TAX AS FLOAT) AS SALES_TAX,
CAST($1 :CONGESTION_SURCHARGE AS FLOAT) AS CONGESTION_SURCHARGE,
CAST($1 :AIRPORT_FEE AS FLOAT) AS AIRPORT_FEE,
CAST($1 :TIPS AS FLOAT) AS TIPS,
CAST($1 :DRIVER_PAY AS FLOAT) AS DRIVER_PAY,
CAST($1 :SHARED_REQUEST_FLAG AS VARCHAR(16777216)) AS SHARED_REQUEST_FLAG,
CAST($1 :SHARED_MATCH_FLAG AS VARCHAR(16777216)) AS SHARED_MATCH_FLAG,
CAST($1 :ACCESS_A_RIDE_FLAG AS VARCHAR(16777216)) AS ACCESS_A_RIDE_FLAG,
CAST($1 :WAV_REQUEST_FLAG AS VARCHAR(16777216)) AS WAV_REQUEST_FLAG,
CAST($1 :WAV_MATCH_FLAG AS VARCHAR(16777216)) AS WAV_MATCH_FLAG

    FROM @{stage_name}

) PATTERN = '.*parquet.*';